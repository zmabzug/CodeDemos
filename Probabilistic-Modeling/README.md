## Probabilistic-Modeling

Welcome! This folder contains code samples in MATLAB that define, fit, and analyze different behavioral models of human decision-making. This goal of this project was to predict human choices as a function of two parallel streams of information: the outcomes of past choices, and visual cues that carry information about how outcome probabilities are changing over time. I built 34 candidate behavioral models, fit data from each subject to each model, and used [Bayesian Model Selection](https://www.ncbi.nlm.nih.gov/pubmed/19306932) to learn which facets of the behavioral models were important for accurate choice prediction. A manuscript from this work is currently under review.

### *master.m*
This is the script that initiates the model fitting procedure. In it, the user can declare the number of times they want to fit each model to each subject (to try and avoid getting stuck in sub-optimal local minima during the optimization routine), which model(s) they want to fit, and whether there are any new subjects that models need to be fit to.

### *simpleInferenceWrapper.m*
This is the function that performs the optimization routine. After parsing the inputs and initializing the file directories, it uses the *getModelParams.m* subfunction to convert the model name into a usable representation and decide which parameters should be optimized and which should be held constant. The main body of the function begins on line 88, where the function begins iterating over the list of subjects and optimizing the model parameters using MATLAB's fmincon routine for minimizing a function output given some constraints. I run fmincon multiple times with randomized starting locations (initial parameters) to protect against local minima, minimize the negative log-likelihood of the model given the data, and then select the best run. Afterwards, some other model performance metrics (such as prediction accuracy and BIC) are calculated and saved for later analysis.

### *simpleInference.m*
This is the function that contains all of the models. The 'params' structure that is generated by *getModelParams.m* serves as the key that tells the model which parameters should be held constant and which should be fitted. In brief, different sources of information (outcomes and visual cues) are tracked dynamically over time to estimate outcome rates (Beta-distributed) and visual cue distributions (Gaussian-distributed) for the current trial. These two sources of information are integrated with behavioral biases to infer the probability that the subject will make a given choice on any given trial. Lastly, the negative log-likelihood is passed out of the function to *simpleInferenceWrapper.m* for minimizing by fmincon.

### *compareModels.m*
This script analyzes and visualizes the model fits. First, it loads all of the model fits for all of the subjects, and extracts the model performance metrics. Then, it uses the spm_BMS function from [MATLAB's SPM package for fMRI analysis](http://www.fil.ion.ucl.ac.uk/spm/software/spm12/) to implement Bayesian model selection, allowing for easy comparison between models and between individual features within models. Lastly, it uses the model selection results and prediction accuracy to generate a variety of figures for easy visualization.